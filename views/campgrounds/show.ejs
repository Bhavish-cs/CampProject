<% layout('layouts/boilerplate') %>
    <div class="row justify-content-center">
        <div class="col-8">
            <div class="card shadow-sm border-0 mb-4">
                <img src="<%= campground.image %>" class="card-img-top img-fluid" alt="..."
                    style="object-fit:cover; height:320px; border-top-left-radius:0.5rem; border-top-right-radius:0.5rem;">
                <div class="card-body">
                    <h5 class="card-title">
                        <%= campground.title %>
                    </h5>
                    <p class="card-text">
                        <%= campground.description %>.
                    </p>
                </div>
                <ul class="list-group list-group-flush">
                    <li class="list-group-item text-muted">
                        <%= campground.location %>
                    </li>
                    <li class="list-group-item">
                        <%= campground.price %>/night
                    </li>

                </ul>
                <div class="card-body px-3 py-2">
                    <div class="d-flex align-items-center gap-2 justify-content-center mb-3">
                        <a class="btn btn-info" href="/campgrounds/<%= campground._id %>/edit">
                            <i class="bi bi-pencil-square"></i> Edit
                        </a>
                        <form class="d-inline" action="/campgrounds/<%=campground._id%>?_method=DELETE" method="POST">
                            <button class="btn btn-danger">
                                <i class="bi bi-trash"></i> Delete
                            </button>
                        </form>
                    </div>
                    <div class="text-center">
                        <a href="/campgrounds" class="btn btn-outline-success fw-bold"
                            style="letter-spacing: 1px; padding: 0.5rem 1.2rem;">
                            <i class="bi bi-arrow-left-circle"></i> All Campgrounds
                        </a>
                    </div>
                </div>
                <!-- Review Submission Form in a separate div -->
            </div> <!-- close card -->
        </div> <!-- close col -->
    </div> <!-- close row -->

    <div class="row justify-content-center mt-4">
        <div class="col-8">
            <div class="card shadow-sm border-0">
                <div class="card-body">
                    <h5 class="mb-3 text-primary"><i class="bi bi-chat-dots"></i> Leave a Review</h5>
                    <form action="/campgrounds/<%= campground._id %>/reviews" method="POST">
                        <div class="mb-3">
                            <label for="reviewBody" class="form-label fw-semibold">Your Review</label>
                            <textarea class="form-control" id="reviewBody" name="review[body]" rows="3"
                                placeholder="Share your experience..." required></textarea>
                        </div>
                        <div class="mb-3">
                            <label class="form-label fw-semibold d-block mb-1">Rating</label>
                            <div id="starRating" class="mb-1" style="font-size:2rem;">
                                <% for(let i=1; i<=5; i++) { %>
                                    <span class="star" data-value="<%=i%>"
                                        style="color:#ddd; cursor:pointer; transition:color 0.2s;">
                                        <i class="bi bi-star-fill"></i>
                                    </span>
                                    <% } %>
                                        <input type="hidden" name="review[rating]" id="ratingInput" required>
                            </div>
                        </div>
                        <button type="submit" class="btn px-4 py-2 fw-bold shadow-sm"
                            style="background: #ffd814; color: #111; border: 1px solid #fcd200; border-radius: 20px; letter-spacing: 1px; box-shadow: 0 2px 5px rgba(0,0,0,0.07); font-weight: 600; font-size: 1.1rem;">
                            <i class="bi bi-send"></i> Submit Review
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <script>
        // Interactive star rating
        document.addEventListener('DOMContentLoaded', function () {
            const stars = document.querySelectorAll('#starRating .star');
            const ratingInput = document.getElementById('ratingInput');
            let selected = 0;
            stars.forEach((star, idx) => {
                star.addEventListener('mouseover', () => {
                    highlightStars(idx + 1);
                });
                star.addEventListener('mouseout', () => {
                    highlightStars(selected);
                });
                star.addEventListener('click', () => {
                    selected = idx + 1;
                    ratingInput.value = selected;
                    highlightStars(selected);
                });
            });
            function highlightStars(count) {
                stars.forEach((star, i) => {
                    star.style.color = i < count ? '#ffd700' : '#ddd';
                });
            }
        });
    </script>
    </div>
    </div>
    </div>
    <p class="text-muted small">
        Posted <%= timeAgo(campground.createdAt) %>
    </p>